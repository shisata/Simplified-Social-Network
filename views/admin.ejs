<!-- Main page after logged in -->
<%- include('./partials/header') %>

<h2> Welcome <%= user.fname %></h2>
<p>Email : <%= user.email %></p>
<p>First Name : <%= user.fname %> </p>
<p>Last Name : <%= user.lname %> </p>
<p>Registered Time: <%= user.date %> </p>

<%- include('./partials/menu_buttons') %>
<body>
    <div>
        <h1>My Feed:</h1>
        <ul>
            <% posts.forEach(function(post) { %>
            <li>
                <div>
                    <% owner = users[post.owner] %>
                    <% if (owner){ %>
                        <header><%= owner.fname %> <%= owner.lname %></header>
                    <% } %>
                    <h4><%= post.Title %></h4>
                    <p><%= post.Body %></p>
                    <p><%= post.date %></p>
                    <form action=/admin/comment method="post">
                        <input type="Text" id="Content" name="Content" placeholder="Type a comment" required>
                        <input type="Hidden" id="post_id" name="post_id" value= <%= post._id %>>
                        <button type="submit" class="btn"> Post </button>
                    </form>
                </div>
                <ul>
                    
                    <% post.comments.forEach(function(id) { %>
                    <% comment = comments[id]; %>
                    <% console.log("id:",id); %>
                    <% console.log("comments:",comments); %>
                    <% u = users[comment.user_id]; %>
                    <li>
                        <% if (u){ %>
                            <header><%= u.fname %> <%= u.lname %></header>
                        <% } %>
                        <p><%= comment.content %></p>
                        <p><%= comment.date %></p>
                    </li>
                    <% }) %>
                </ul>           
            </li>
            <% }); %>
        </ul>
    </div>
</body>